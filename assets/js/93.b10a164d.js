(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{449:function(s,e,a){"use strict";a.r(e);var n=a(25),t=Object(n.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker-compose-部署-nexus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-部署-nexus"}},[s._v("#")]),s._v(" Docker Compose 部署 Nexus")]),s._v(" "),a("h2",{attrs:{id:"什么是-nexus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是-nexus"}},[s._v("#")]),s._v(" 什么是 Nexus")]),s._v(" "),a("p",[s._v("Nexus 是一个强大的 Maven 仓库管理器，极大地简化了内部仓库的维护和外部仓库的访问。2016 年 4 月 6 日 Nexus 3.0 版本发布，相较 2.x 版本有了很大的改变")]),s._v(" "),a("ul",[a("li",[s._v("对低层代码进行了大规模重构，提升性能，增加可扩展性以及改善用户体验。")]),s._v(" "),a("li",[s._v("升级界面，极大的简化了用户界面的操作和管理。")]),s._v(" "),a("li",[s._v("提供新的安装包，让部署更加简单。")]),s._v(" "),a("li",[s._v("增加对 Docker, NeGet, npm, Bower 的支持。")]),s._v(" "),a("li",[s._v("提供新的管理接口，以及增强对自动任务的管理。")])]),s._v(" "),a("h2",{attrs:{id:"部署-nexus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署-nexus"}},[s._v("#")]),s._v(" 部署 Nexus")]),s._v(" "),a("p",[s._v("我们使用 Docker 来安装和运行 Nexus，docker-compose.yml 配置如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("version: '3.1'\nservices:\n  nexus:\n    restart: always\n    image: sonatype/nexus3\n    container_name: nexus\n    ports:\n      - 80:8081\n    volumes:\n      - data:/nexus-data\nvolumes:\n  data:\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h2",{attrs:{id:"验证安装是否成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证安装是否成功"}},[s._v("#")]),s._v(" 验证安装是否成功")]),s._v(" "),a("ul",[a("li",[s._v("地址： http://ip:port/")]),s._v(" "),a("li",[s._v("用户名： admin")]),s._v(" "),a("li",[s._v("密码： admin123")])]),s._v(" "),a("blockquote",[a("p",[s._v("注意： 新版本密码在 "),a("code",[s._v("cat /var/lib/docker/volumes/nexus_data/_data/admin.password")])])]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"http://ww1.sinaimg.cn/large/007Rnr4nly1g8lx5e3ge8j31h80jldhn.jpg"}})]),s._v(" "),a("h2",{attrs:{id:"在项目中使用-nexus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在项目中使用-nexus"}},[s._v("#")]),s._v(" 在项目中使用 Nexus")]),s._v(" "),a("h3",{attrs:{id:"配置认证信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置认证信息"}},[s._v("#")]),s._v(" 配置认证信息")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("Maven settings.xml")]),s._v("中添加 Nexus 认证信息 (servers 节点下)")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<server>\n  <id>nexus-releases</id>\n  <username>admin</username>\n  <password>admin123</password>\n</server>\n<server>\n  <id>nexus-snapshots</id>\n  <username>admin</username>\n  <password>admin123</password>\n</server>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"snapshots-与-releases-的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#snapshots-与-releases-的区别"}},[s._v("#")]),s._v(" Snapshots 与 Releases 的区别")]),s._v(" "),a("ul",[a("li",[s._v("nexus-releases： 用于发布 Release 版本")]),s._v(" "),a("li",[s._v("nexus-snapshots： 用于发布 Snapshot 版本（快照版）")])]),s._v(" "),a("p",[s._v("Release 版本与 Snapshot 定义")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Release: 1.0.0/1.0.0-RELEASE\nSnapshot: 1.0.0-SNAPSHOT\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ul",[a("li",[s._v("在项目 pom.xml 中设置的版本号添加 SNAPSHOT 标识的都会发布为 SNAPSHOT 版本，没有 SNAPSHOT 标识的都会发布为 RELEASE 版本。")]),s._v(" "),a("li",[s._v("SNAPSHOT 版本会自动加一个时间作为标识，如：1.0.0-SNAPSHOT 发布后为变成 1.0.0-SNAPSHOT-20180522.123456-1.jar")])]),s._v(" "),a("h3",{attrs:{id:"配置自动化部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置自动化部署"}},[s._v("#")]),s._v(" 配置自动化部署")]),s._v(" "),a("p",[s._v("在 pom.xml 中添加如下代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<distributionManagement>  \n  <repository>  \n    <id>nexus-releases</id>  \n    <name>Nexus Release Repository</name>  \n    <url>http://127.0.0.1:8081/repository/maven-releases/</url>  \n  </repository>  \n  <snapshotRepository>  \n    <id>nexus-snapshots</id>  \n    <name>Nexus Snapshot Repository</name>  \n    <url>http://127.0.0.1:8081/repository/maven-snapshots/</url>  \n  </snapshotRepository>  \n</distributionManagement> \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("注意事项")]),s._v(" "),a("ul",[a("li",[s._v("ID 名称必须要与 settings.xml 中 Servers 配置的 ID 名称保持一致")]),s._v(" "),a("li",[s._v("项目版本号中有 SNAPSHOT 标识的，会发布到 Nexus Snapshots Repository， 否则发布到 Nexus Release Repository，并根据 ID 去匹配授权账号")])])]),s._v(" "),a("h3",{attrs:{id:"部署到仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署到仓库"}},[s._v("#")]),s._v(" 部署到仓库")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mvn deploy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"配置代理仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置代理仓库"}},[s._v("#")]),s._v(" 配置代理仓库")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<repositories>\n    <repository>\n        <id>nexus</id>\n        <name>Nexus Repository</name>\n        <url>http://127.0.0.1:8081/repository/maven-public/</url>\n        <snapshots>\n            <enabled>true</enabled>\n        </snapshots>\n        <releases>\n            <enabled>true</enabled>\n        </releases>\n    </repository>\n</repositories>\n<pluginRepositories>\n    <pluginRepository>\n        <id>nexus</id>\n        <name>Nexus Plugin Repository</name>\n        <url>http://127.0.0.1:8081/repository/maven-public/</url>\n        <snapshots>\n            <enabled>true</enabled>\n        </snapshots>\n        <releases>\n            <enabled>true</enabled>\n        </releases>\n    </pluginRepository>\n</pluginRepositories>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("p",[s._v("##　扩展阅读")]),s._v(" "),a("h3",{attrs:{id:"手动上传第三方依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动上传第三方依赖"}},[s._v("#")]),s._v(" 手动上传第三方依赖")]),s._v(" "),a("p",[s._v("Nexus 3.1.x 开始支持页面上传第三方依赖功能，以下为手动上传命令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 如第三方JAR包：aliyun-sdk-oss-2.2.3.jar\nmvn deploy:deploy-file \n  -DgroupId=com.aliyun.oss \n  -DartifactId=aliyun-sdk-oss \n  -Dversion=2.2.3 \n  -Dpackaging=jar \n  -Dfile=D:\\aliyun-sdk-oss-2.2.3.jar \n  -Durl=http://127.0.0.1:8081/repository/maven-3rd/ \n  -DrepositoryId=nexus-releases\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("注意事项")]),s._v(" "),a("ul",[a("li",[s._v("建议在上传第三方 JAR 包时，创建单独的第三方 JAR 包管理仓库，便于管理有维护。（maven-3rd）")]),s._v(" "),a("li",[s._v("-DrepositoryId=nexus-releases 对应的是 settings.xml 中 Servers 配置的 ID 名称。（授权）")])])])])}),[],!1,null,null,null);e.default=t.exports}}]);