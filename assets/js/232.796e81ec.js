(window.webpackJsonp=window.webpackJsonp||[]).push([[232],{585:function(n,s,e){"use strict";e.r(s);var a=e(25),t=Object(a.a)({},(function(){var n=this,s=n.$createElement,e=n._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"nginx-虚拟主机"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx-虚拟主机"}},[n._v("#")]),n._v(" Nginx 虚拟主机")]),n._v(" "),e("h2",{attrs:{id:"什么是-nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是-nginx"}},[n._v("#")]),n._v(" 什么是 Nginx")]),n._v(" "),e("p",[n._v("Nginx 是一款高性能的 HTTP 服务器/反向代理服务器及电子邮件（IMAP/POP3）代理服务器。由俄罗斯的程序设计师 Igor Sysoev 所开发，官方测试 Nginx 能够支支撑 5 万并发链接，并且 CPU、内存等资源消耗却非常低，运行非常稳定。")]),n._v(" "),e("h2",{attrs:{id:"nginx-的应用场景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx-的应用场景"}},[n._v("#")]),n._v(" Nginx 的应用场景")]),n._v(" "),e("ul",[e("li",[n._v("HTTP 服务器：Nginx 是一个 HTTP 服务可以独立提供 HTTP 服务。可以做网页静态服务器。")]),n._v(" "),e("li",[n._v("虚拟主机：可以实现在一台服务器虚拟出多个网站。例如个人网站使用的虚拟主机。")]),n._v(" "),e("li",[n._v("反向代理，负载均衡：当网站的访问量达到一定程度后，单台服务器不能满足用户的请求时，需要用多台服务器集群可以使用 Nginx 做反向代理。并且多台服务器可以平均分担负载，不会因为某台服务器负载高宕机而某台服务器闲置的情况。")])]),n._v(" "),e("h2",{attrs:{id:"nginx-虚拟主机-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx-虚拟主机-2"}},[n._v("#")]),n._v(" Nginx 虚拟主机")]),n._v(" "),e("h3",{attrs:{id:"什么是虚拟主机"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是虚拟主机"}},[n._v("#")]),n._v(" 什么是虚拟主机")]),n._v(" "),e("p",[n._v("虚拟主机是一种特殊的软硬件技术，它可以将网络上的每一台计算机分成多个虚拟主机，每个虚拟主机可以独立对外提供 www 服务，这样就可以实现一台主机对外提供多个 web 服务，每个虚拟主机之间是独立的，互不影响的。")]),n._v(" "),e("p",[n._v("通过 Nginx 可以实现虚拟主机的配置，Nginx 支持三种类型的虚拟主机配置")]),n._v(" "),e("ul",[e("li",[n._v("基于 IP 的虚拟主机")]),n._v(" "),e("li",[n._v("基于域名的虚拟主机")]),n._v(" "),e("li",[n._v("基于端口的虚拟主机")])]),n._v(" "),e("h2",{attrs:{id:"nginx-配置文件的结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx-配置文件的结构"}},[n._v("#")]),n._v(" Nginx 配置文件的结构")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("# ...\nevents {\n    # ...\n}\nhttp {\n    # ...\n    server{\n        # ...\n    }\n    # ...\n    server{\n        # ...\n    }\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br")])]),e("blockquote",[e("p",[n._v("注意： 每个 server 就是一个虚拟主机")])]),n._v(" "),e("h2",{attrs:{id:"基于-docker-部署-nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基于-docker-部署-nginx"}},[n._v("#")]),n._v(" 基于 Docker 部署 Nginx")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("version: '3.1'\nservices:\n  nginx:\n    restart: always\n    image: nginx\n    container_name: nginx\n    ports:\n      - 80:80\n      - 8080:8080\n    volumes:\n      - ./conf/nginx.conf:/etc/nginx/nginx.conf\n      - ./html:/usr/share/nginx/html\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br")])]),e("h3",{attrs:{id:"基于端口的虚拟主机配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基于端口的虚拟主机配置"}},[n._v("#")]),n._v(" 基于端口的虚拟主机配置")]),n._v(" "),e("p",[n._v("需求")]),n._v(" "),e("ul",[e("li",[n._v("Nginx 对外提供 80 和 8080 两个端口监听服务")]),n._v(" "),e("li",[n._v("请求 80 端口则请求 html80 目录下的 html")]),n._v(" "),e("li",[n._v("请求 8080 端口则请求 html8080 目录下的 html")])]),n._v(" "),e("p",[n._v("操作流程")]),n._v(" "),e("ul",[e("li",[n._v("创建目录及文件，在 "),e("code",[n._v("/usr/local/docker/nginx/html")]),n._v("目录下创建 "),e("code",[n._v("html80")]),n._v(" 和 "),e("code",[n._v("html8080")]),n._v(" 两个目录，并分别创建两个 "),e("code",[n._v("index.html")]),n._v(" 文件")]),n._v(" "),e("li",[n._v("配置虚拟主机，创建并修改 "),e("code",[n._v("/usr/local/docker/nginx/conf")]),n._v(" 目录下的 "),e("code",[n._v("nginx.conf")])])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("# 启动进程,通常设置成和 CPU 的数量相等,几核就填几\nworker_processes  2;\nevents {\n    # epoll 是多路复用 IO(I/O Multiplexing) 中的一种方式\n    # 但是仅用于 linux2.6 以上内核,可以大大提高 nginx 的性能\n    use epoll;\n    # 单个后台 worker process 进程的最大并发链接数\n    worker_connections  1024;\n}\nhttp {\n    # 设定 mime 类型,类型由 mime.type 文件定义\n    include       mime.types;\n    default_type  application/octet-stream;\n    # sendfile 指令指定 nginx 是否调用 sendfile 函数（zero copy 方式）来输出文件，对于普通应用，\n    # 必须设为 on，如果用来进行下载等应用磁盘 IO 重负载应用，可设置为 off，以平衡磁盘与网络 I/O 处理速度，降低系统的 uptime.\n    sendfile        on;\n    # 连接超时时间\n    keepalive_timeout  65;\n    # 设定请求缓冲\n    client_header_buffer_size 2k;\n    # 配置虚拟主机 192.168.27.121\n    server {\n    # 监听的 IP 和端口，配置 192.168.27.121:80\n        listen       80;\n    # 虚拟主机名称这里配置 IP 地址\n        server_name  192.168.27.121;\n    # 所有的请求都以 / 开始，所有的请求都可以匹配此 location\n        location / {\n        # 使用 root 指令指定虚拟主机目录即网页存放目录\n        # 比如访问 http://ip/index.html 将找到 /usr/local/docker/nginx/html/html80/index.html\n        # 比如访问 http://ip/item/index.html 将找到 /usr/local/docker/nginx/html/html80/item/index.html\n            root   /usr/share/nginx/html/html80;\n        # 指定欢迎页面，按从左到右顺序查找\n            index  index.html index.htm;\n        }\n    }\n    # 配置虚拟主机 192.168.27.121\n    server {\n        listen       8080;\n        server_name  192.168.27.121;\n        location / {\n            root   /usr/share/nginx/html/html8080;\n            index  index.html index.htm;\n        }\n    }\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br")])]),e("h3",{attrs:{id:"基于域名的虚拟主机配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基于域名的虚拟主机配置"}},[n._v("#")]),n._v(" 基于域名的虚拟主机配置")]),n._v(" "),e("p",[n._v("需求")]),n._v(" "),e("ul",[e("li",[n._v("两个域名指向同一台 Nginx 服务器，用户访问不同的域名显示不同的网页内容")]),n._v(" "),e("li",[n._v("两个域名是 ingress.funtl.com 和 service.funtl.com")]),n._v(" "),e("li",[n._v("Nginx 服务器使用虚拟机 192.168.27.121")])]),n._v(" "),e("p",[n._v("操作流程")]),n._v(" "),e("ul",[e("li",[n._v("配置 Hosts，通过 host 文件指定 service1.funtl.com 和 service2.funtl.com 对应 192.168.27.121 虚拟机，修改 window 的 hosts 文件：（C:\\Windows\\System32\\drivers\\etc）")]),n._v(" "),e("li",[n._v("创建目录及文件，在 "),e("code",[n._v("/usr/local/docker/nginx/html")]),n._v(" 目录下创建 "),e("code",[n._v("service1")]),n._v(" 和 "),e("code",[n._v("service2")]),n._v(" 两个目录，并分别创建两个 index.html 文件")]),n._v(" "),e("li",[n._v("配置虚拟主机，修改 "),e("code",[n._v("/usr/local/docker/nginx/conf")]),n._v(" 目录下的 nginx.conf")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("user  nginx;\nworker_processes  2;\nevents {\n    use epoll;\n    worker_connections  1024;\n}\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n    sendfile        on;\n    keepalive_timeout  65;\n    server {\n        listen       80;\n        server_name  service1.funtl.com;\n        location / {\n            root   /usr/share/nginx/html/service1;\n            index  index.html index.htm;\n        }\n    }\n    server {\n        listen       80;\n        server_name  service2.funtl.com;\n        location / {\n            root   /usr/share/nginx/html/service2;\n            index  index.html index.htm;\n        }\n    }\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br")])])])}),[],!1,null,null,null);s.default=t.exports}}]);