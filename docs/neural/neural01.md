# 神经网络实现
## 1.数据预处理 
在训练神经网络前一般需要对数据进行预处理，一种重要的预处理手段是**归一化**处理。下面简要介绍归一化处理的原理与方法。
### (1)什么是归一化？ 
数据归一化，就是将数据映射到[0,1]或[-1,1]区间或更小的区间，比如(0.1,0.9)。
 
::: tip 为什么要归一化处理？
- 输入数据的**单位**不一样，有些数据的范围可能特别大，导致的结果是神经网络收敛慢、训练时间长。
- 数据范围大的输入在模式分类中的作用可能会偏大，而数据范围小的输入作用就可能会偏小。
- 由于神经网络输出层的激活函数的值域是有限制的，因此需要将网络训练的目标数据映射到激活函数的值域。例如神经网络的输出层若采用S形激活函数，由于S形函数的值域限制在(0,1)，也就是说神经网络的输出只能限制在(0,1)，所以训练数据的输出就要归一化到[0,1]区间。
- S形激活函数在(0,1)区间以外区域很平缓，区分度太小。例如S形函数f(X)在参数a=1时，f(100)与f(5)只相差0.0067。
:::
### (2) 归一化算法 
一种简单而快速的归一化算法是线性转换算法。线性转换算法常见有两种形式：
$$y=(x-min)/(max-min) \qquad (1)$$
其中$min$为$x$的最小值，$max$为$x$的最大值，输入向量为$x$，归一化后的输出向量为$y$ 。上式将数据归一化到 $[ 0 , 1 ]$区间，当激活函数采用S形函数时(值域为$(0,1)$)时这条式子适用。
$$y=2*(x-min)/(max-min)-1 \qquad (2)$$
这条公式将数据归一化到$[ -1 , 1 ]$区间。当激活函数采用双极S形函数(值域为$(-1,1)$)时这条式子适用。

### (3)Matlab数据归一化处理函数 
Matlab中归一化处理数据可以采用**premnmx**，**postmnmx**，**tramnmx**这3个函数。
#### <1>premnmx
$$[p_n,min_p,max_p,t_n,min_t,max_t] = premnmx(p,t)$$

::: tip 参数：
- $p_n$： p矩阵按行归一化后的矩阵
- $min_p$，$max_p$：p矩阵每一行的最小值，最大值
- $t_n$：t矩阵按行归一化后的矩阵
- $min_t$，$max_t$：t矩阵每一行的最小值，最大值
:::
作用：将矩阵p，t归一化到$[-1,1]$ ，主要用于归一化处理训练数据集。

#### <2>tramnmx
$$[p_n] = tramnmx(p,min_p,max_p)$$

::: tip 参数：
- $min_p$，$max_p$：premnmx函数计算的矩阵的最小，最大值
- $p_n$：归一化后的矩阵
:::
作用：主要用于归一化处理待分类的输入数据。

#### <3>postmnmx
$$[p,t] = postmnmx(p_n,min_p,max_p,t_n,min_t,max_t)$$

::: tip 参数：
- $min_p$，$max_p$：premnmx函数计算的p矩阵每行的最小值，最大值
- $min_t$，$max_t$：premnmx函数计算的t矩阵每行的最小值，最大值
:::
作用：将矩阵$p_n$，$t_n$映射回归一化处理前的范围。postmnmx函数主要用于将神经网络的输出结果映射回归一化前的数据范围。

## 2.使用Matlab实现神经网络 
使用Matlab建立前馈神经网络主要会使用到下面3个函数：
- newff ：前馈网络创建函数
- train：训练一个神经网络
- sim ：使用网络进行仿真

### newff函数
#### 1.newff函数语法
newff函数参数列表有很多的可选参数，具体可以参考Matlab的帮助文档，这里介绍newff函数的一种简单形式。

$$net=newff( A, B, {C} ,'trainFun')$$

::: tip 参数
- A：一个n×2的矩阵，第i行元素为输入信号xi的最小值和最大值；
- B：一个k维行向量，其元素为网络中各层节点数；
- C：一个k维字符串行向量，每一分量为对应层神经元的激活函数；
- trainFun ：为学习规则采用的训练算法。
:::

#### 2.常用的激活函数
常用的激活函数有：
- 线性函数 (Linear transfer function)

$$f(x) = x$$
该函数的字符串为`purelin`。
-  对数S形转移函数( Logarithmic sigmoid transfer function )
$$f(x)=\frac{1}{1+e^{-x}} \quad (0<f(x)<1)$$
该函数的字符串为`logsig`。

- 双曲正切S形函数 (Hyperbolic tangent sigmoid transfer function )
$$f(x)=\frac{2}{1+e^{-2n}}-1 \quad (-1<f(x)<1)$$
也就是上面所提到的双极S形函数,Matlab的安装目录下的`toolbox\nnet\nnet\nntransfer`子目录中有所有激活函数的定义说明。

该函数的字符串为`tansig`。

#### 3.常见的训练函数
常见的训练函数有：
- traingd ：梯度下降BP训练函数(Gradient descent backpropagation)
- traingdx ：梯度下降自适应学习率训练函数

#### 4.网络配置参数
::: tip 一些重要的网络配置参数如下：
- net.trainparam.goal：神经网络训练的目标误差
- net.trainparam.show： 显示中间结果的周期
- net.trainparam.epochs：最大迭代次数
- net.trainParam.lr： 学习率
:::

### train函数
网络训练学习函数。
$$[ net, tr, Y_1, E ]  = train( net, X, Y )$$

::: tip 参数：
- X：网络实际输入
- Y：网络应有输出
- tr：训练跟踪信息
- $Y_1$：网络实际输出
- E：误差矩阵
:::
### sim函数
$$Y=sim(net,X)$$

::: tip 参数：
- net：网络
- X：输入给网络的Ｋ×N矩阵，其中K为网络输入个数，N为数据样本数
- Y：输出矩阵Q×N，其中Q为网络输出个数
:::